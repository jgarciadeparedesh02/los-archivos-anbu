<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detalle Digimon</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-gradient-to-b from-blue-900 to-blue-700 flex flex-col items-center p-6 font-sans">

  <div class="relative z-10 w-full max-w-3xl mx-auto flex flex-col items-center p-6">
    <!-- Bot√≥n volver -->
    <button onclick="window.history.back()"
      class="self-start mb-6 bg-white/20 backdrop-blur-md text-white px-5 py-2 rounded-lg shadow-lg hover:scale-105 active:scale-95 hover:shadow-xl transition-all duration-300 flex items-center gap-2 border border-blue-200/50 font-semibold">
      ‚¨Ö Volver
    </button>

    <!-- Contenedor principal -->
    <div id="detailContainer"
      class="relative z-10 max-w-3xl w-full bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl p-8 flex flex-col items-center text-center border border-blue-200/50">
      <!-- ... contenido del detalle ... -->
    </div>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");
    const apiUrl = `https://digi-api.com/api/v1/digimon/${id}`;
    const container = document.getElementById("detailContainer");
    const defaultImageUrl = 'https://upload.wikimedia.org/wikipedia/en/4/46/Digimon_logo.png';

    // Shimmer effect for loading detail
    const shimmerDetail = `
      <div class="relative z-10 max-w-3xl w-full bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl p-8 flex flex-col items-center text-center border border-blue-200/50 animate-pulse">
        <div class="w-64 h-64 bg-gray-700 rounded-xl mb-6"></div>
        <div class="h-10 bg-gray-700 rounded w-3/4 mb-3"></div>
        <div class="h-6 bg-gray-700 rounded w-full mb-6"></div>
        <div class="grid grid-cols-2 gap-4 w-full bg-gray-800/50 rounded-2xl p-4 mb-8">
          <div class="h-5 bg-gray-700 rounded"></div>
          <div class="h-5 bg-gray-700 rounded"></div>
          <div class="h-5 bg-gray-700 rounded"></div>
          <div class="h-5 bg-gray-700 rounded"></div>
        </div>
        <div class="h-8 bg-gray-700 rounded w-1/2 mb-4"></div>
        <div class="flex flex-wrap justify-center items-center gap-4">
          <div class="w-28 h-28 bg-gray-700 rounded-lg"></div>
          <div class="w-28 h-28 bg-gray-700 rounded-lg"></div>
          <div class="w-28 h-28 bg-gray-700 rounded-lg"></div>
        </div>
      </div>
    `;

    async function fetchDetail() {
      container.innerHTML = shimmerDetail;
      try {
        const res = await fetch(apiUrl);
        const data = await res.json();

        // ----- SECCI√ìN PRINCIPAL -----
        container.innerHTML = `
          <div class="relative z-10 flex flex-col items-center max-w-3xl w-full bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl p-8 text-center border border-blue-200/50">
            <div class="relative mb-6">
              <img src="${data.images?.[0]?.href || defaultImageUrl}" 
                   alt="${data.name}" 
                   class="w-64 h-64 object-contain rounded-xl shadow-lg border border-blue-400/50 bg-white/20 p-2">
              <div class="absolute top-2 right-2 bg-blue-600/80 text-white text-xs px-3 py-1 rounded-full shadow-md font-bold">
                #${data.id}
              </div>
            </div>

            <h1 class="text-5xl font-extrabold text-white drop-shadow-md mb-4">${data.name}</h1>
            <p class="text-blue-200 text-lg italic mb-6 max-w-xl leading-relaxed">
              ${data.description || "Sin descripci√≥n disponible. Este Digimon a√∫n es un misterio..."}
            </p>

            <div class="grid grid-cols-2 gap-4 w-full bg-white/10 backdrop-blur-sm rounded-2xl shadow p-4 text-left text-white font-medium border border-blue-200/50 mb-8">
              <p><strong>Nivel:</strong> ${data.levels?.map(l => l.level).join(', ') || 'Desconocido'}</p>
              <p><strong>Atributo:</strong> ${data.attributes?.map(a => a.attribute).join(', ') || 'Desconocido'}</p>
              <p><strong>Tipo:</strong> ${data.types?.map(t => t.type).join(', ') || 'Desconocido'}</p>
              <p><strong>Campo:</strong> ${data.fields?.map(f => f.field).join(', ') || 'Desconocido'}</p>
            </div>

            <div id="evolutionContainer" class="w-full"></div>
          </div>
        `;

        // ----- EVOLUCIONES -----
        const evoContainer = document.getElementById("evolutionContainer");

        const hasEvolutions = data.priorEvolutions?.length || data.nextEvolutions?.length;

        if (hasEvolutions) {
          let evoHTML = `<h2 class="text-2xl font-bold text-white mb-6 drop-shadow-md">üß¨ L√≠nea Evolutiva</h2>`;
          evoHTML += `<div class="flex flex-col items-center w-full">`;

          // Evoluciones anteriores
          if (data.priorEvolutions?.length) {
            evoHTML += `<h3 class="text-xl font-semibold text-blue-200 mb-3">Evoluciones Anteriores</h3>`;
            evoHTML += `<div class="flex flex-wrap justify-center items-center gap-4 mb-6">`;
            data.priorEvolutions.forEach(prev => {
              evoHTML += `
                <div onclick="goToDetail(${prev.id})" 
                     class="cursor-pointer text-center transition-all duration-300 hover:scale-105 hover:shadow-xl p-2 rounded-lg bg-white/10 backdrop-blur-sm border border-blue-200/50 relative overflow-hidden">
                  <div class="absolute inset-0 bg-gradient-to-br from-blue-500/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                  <div class="relative z-10">
                    <img src="${prev.image || defaultImageUrl}" 
                         alt="${prev.digimon}" 
                         class="w-28 h-28 object-contain mx-auto mb-2 rounded-lg bg-white/20 shadow border border-blue-300/50 p-1">
                    <p class="text-sm font-semibold text-white">${prev.digimon}</p>
                  </div>
                </div>
              `;
            });
            evoHTML += `</div>`;
            evoHTML += `<span class="text-4xl font-bold text-blue-400 my-4 drop-shadow-md">‚¨áÔ∏è</span>`; // Flecha hacia abajo
          }

          // Digimon actual
          evoHTML += `<h3 class="text-xl font-semibold text-blue-200 mb-3">Digimon Actual</h3>`;
          evoHTML += `
            <div class="text-center mb-6 bg-white/10 backdrop-blur-sm rounded-lg p-2 border border-blue-200/50 shadow-lg">
              <img src="${data.images?.[0]?.href || defaultImageUrl}" 
                   alt="${data.name}" 
                   class="w-32 h-32 object-contain mx-auto mb-2 rounded-lg bg-white/20 shadow border border-blue-300/50 p-1">
              <p class="text-base font-bold text-white">${data.name}</p>
            </div>
          `;

          // Evoluciones posteriores
          if (data.nextEvolutions?.length) {
            evoHTML += `<span class="text-4xl font-bold text-blue-400 my-4 drop-shadow-md">‚¨áÔ∏è</span>`; // Flecha hacia abajo
            evoHTML += `<h3 class="text-xl font-semibold text-blue-200 mb-3">Evoluciones Posteriores</h3>`;
            evoHTML += `<div class="flex flex-wrap justify-center items-center gap-4">`;
            data.nextEvolutions.forEach(next => {
              evoHTML += `
                <div onclick="goToDetail(${next.id})" 
                     class="cursor-pointer text-center transition-all duration-300 hover:scale-105 hover:shadow-xl p-2 rounded-lg bg-white/10 backdrop-blur-sm border border-blue-200/50 relative overflow-hidden">
                  <div class="absolute inset-0 bg-gradient-to-br from-blue-500/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                  <div class="relative z-10">
                    <img src="${next.image || defaultImageUrl}" 
                         alt="${next.digimon}" 
                         class="w-28 h-28 object-contain mx-auto mb-2 rounded-lg bg-white/20 shadow border border-blue-300/50 p-1">
                    <p class="text-sm font-semibold text-white">${next.digimon}</p>
                  </div>
                </div>
              `;
            });
            evoHTML += `</div>`;
          }

          evoHTML += `</div>`;
          evoContainer.innerHTML = evoHTML;
        } else {
          evoContainer.innerHTML = `<p class="text-blue-200 italic relative z-10">Este Digimon no tiene evoluciones registradas.</p>`;
        }

      } catch (error) {
        console.error(error);
        container.innerHTML = `<p class="text-red-400 font-semibold relative z-10">Error al cargar el detalle del Digimon.</p>`;
      }
    }

    function goToDetail(id) {
      window.location.href = "detail.html?id=" + id;
    }

    fetchDetail();
  </script>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 0.6s ease-in-out forwards;
    }
  </style>
</body>

</html>